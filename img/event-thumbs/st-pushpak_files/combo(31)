YUI.add("hermes-template-photo-list-album",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){return"interaction-view"}function c(e,t){return"click-target"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=this,a="function",f=this.escapeExpression;s+='<a class="',o=n["if"].call(t,t.hasInteraction,{hash:{},inverse:u.program(3,c,i),fn:u.program(1,l,i),data:i});if(o||o===0)s+=o;return s+=' avatar photo-list-album album ginormous" href="',(o=n.albumPageUrl)?o=o.call(t,{hash:{},data:i}):(o=t.albumPageUrl,o=typeof o===a?o.apply(t):o),s+=f(o)+'" title="',(o=n.albumTitle)?o=o.call(t,{hash:{},data:i}):(o=t.albumTitle,o=typeof o===a?o.apply(t):o),s+=f(o)+'"></a>\n',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-list-album",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-list-album-view",function(e){var t=require("lib/helpers/type-validator");e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{initializer:function(e){return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){var e=this.get("container");return this.updateGeometry(),this.setContainerHTML(this.templates("photo-list-album")({albumPageUrl:this.get("model").getValue("url"),hasInteraction:!!this.get("interactionViewName")&&!this.appContext.forceServerRender,albumTitle:this.get("model").getValue("title")})),YUI.Env.isServer?(e.setStyles({"background-image":"url("+this.get("photoUrl")+")"}),this.get("model").getValue("primaryNeedsInterstitial")&&e.addClass("restricted-image")):this.downloadCacheAndSetImage(),this},activate:function(){return this.renderInteractionView().then(function(e){this.fire("activated"),this.get("container").addClass("awake")}.bind(this)),this},downloadCacheAndSetImage:function(){e.fluid.loadImage(this.get("photoUrl"),{timeout:1e3,retry:!0}).then(function(e){this.handleImageLoad(!0,e)}.bind(this),function(e){this.handleImageLoad(!1,e+"?retry="+Date.now())}.bind(this))},handleImageLoad:function(t,n){var r;r=this.get("container"),r.setStyle("backgroundImage","url("+n+")"),t||r.setStyle("backgroundColor","#eee"),this.get("model").getValue("primaryNeedsInterstitial")&&r.addClass("restricted-image"),e.fluid.chill(function(){this.fire(t?"loaded":"loadError")},this),r=null},updateGeometry:function(e){var t;e?this.set("layoutItem",e):e=this.get("layoutItem"),t=this.get("container"),this.updateNodeGeometry(e,t),t=null},updateNodeGeometry:function(t,n){YUI.Env.isServer?n.setStyles({transform:"translate("+t.geometry.left+"px, "+t.geometry.top+"px)","-webkit-transform":"translate("+t.geometry.left+"px, "+t.geometry.top+"px)","-ms-transform":"translate("+t.geometry.left+"px, "+t.geometry.top+"px)"}):e.fluid.setStylePrefixed("transform","translate("+t.geometry.left+"px, "+t.geometry.top+"px)",n),n.setStyles({width:t.geometry.width+"px",height:t.geometry.height+"px"})},renderInteractionView:function(){var t=this.get("interactionViewName"),n=this.get("interactionView"),r;return t&&!n?this.appContext.getView(t,e.merge(this._params,{id:this.get("id"),container:this.get("interactionContainer"),model:this.get("model"),albumPageUrl:this.get("model").getValue("url"),isActiveViewAgnostic:this.get("isActiveViewAgnostic"),engagementModelName:this.get("engagementModelName")})).then(function(e){return this.set("interactionView",e),e.initialize()}.bind(this)):n?(n.get("container").inDoc()||(r=n.get("container"),r.addClass("interaction-view"),this.get("container").replaceChild(r,this.get("interactionContainer")),n.normalizedActivate()),e.Promise.resolve(n)):e.Promise.resolve(null)},destroyInteractionView:function(){var e=this.get("interactionView");e&&(e.destroy(),this.set("interactionView",null))}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(e,n){return t.photoId(e)}},parentSignature:{writeOnce:"initOnly"},layoutItem:{validator:function(e,t){return typeof e=="object"&&e.hasOwnProperty("geometry")&&typeof e.geometry=="object"&&e.geometry.hasOwnProperty("width")&&e.geometry.hasOwnProperty("height")&&e.geometry.hasOwnProperty("top")&&e.geometry.hasOwnProperty("left")}},photoUrl:{value:"/images/spaceball.gif",getter:function(t,n){var r=this.get("model").getValue("primaryPhotoSizes"),i=this.get("layoutItem"),s=e.PhotoModelHelper.getSizeToFit(this.get("model").id,{width:i.geometry.width,height:i.geometry.height},{sizes:r,includeSquare:!0,cropToFit:!0});return s?s.src:""}},model:{value:null},parentContainer:{writeOnce:"initOnly"},measureAFT:{value:!1,validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)}},placeHolderHTML:{value:'<div class="youcansleepwhenyouredead" />',validator:function(t,n){return e.AttributeHelpers.validateString(t)}},interactionViewName:{writeOnce:"initOnly",value:null,validator:function(t,n){return e.AttributeHelpers.validateString(t)}},engagementModelName:{writeOnce:"initOnly",value:null,validator:function(t,n){return e.AttributeHelpers.validateString(t)}},interactionView:{value:null},interactionContainer:{value:null,getter:function(e,t){return!e&&!YUI.Env.isServer&&(e=this.get("container").one(".interaction-view")),e}}}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-list-album","photo-list-album-css","url-helper","attribute-helpers","photo-model-helper"],optionalRequires:["fluid","storage-helper"]});
