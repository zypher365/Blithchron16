YUI.add("hermes-template-head-link",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){var r="",i;return r+='id="',(i=n.id)?i=i.call(e,{hash:{},data:t}):(i=e.id,i=typeof i===u?i.apply(e):i),r+=a(i)+'"',r}function h(e,t){var r="",i;return r+='rev="',(i=n.rev)?i=i.call(e,{hash:{},data:t}):(i=e.rev,i=typeof i===u?i.apply(e):i),r+=a(i)+'"',r}function p(e,t){var r="",i;return r+='rel="',(i=n.rel)?i=i.call(e,{hash:{},data:t}):(i=e.rel,i=typeof i===u?i.apply(e):i),r+=a(i)+'"',r}function d(e,t){var r="",i;return r+='type="',(i=n.type)?i=i.call(e,{hash:{},data:t}):(i=e.type,i=typeof i===u?i.apply(e):i),r+=a(i)+'"',r}function v(e,t){var r="",i;return r+='media="',(i=n.media)?i=i.call(e,{hash:{},data:t}):(i=e.media,i=typeof i===u?i.apply(e):i),r+=a(i)+'"',r}function m(e,t){var r="",i;return r+='href="',(i=n.href)?i=i.call(e,{hash:{},data:t}):(i=e.href,i=typeof i===u?i.apply(e):i),r+=a(i)+'"',r}function g(e,t){var r="",i,s;return r+='data-dynamic-added-by="',s={hash:{},data:t},r+=a((i=n.obfuscateInternals||e.obfuscateInternals,i?i.call(e,e.addedBy,s):f.call(e,"obfuscateInternals",e.addedBy,s)))+'"',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression,f=n.helperMissing,l=this;s+="<link ",o=n["if"].call(t,t.id,{hash:{},inverse:l.noop,fn:l.program(1,c,i),data:i});if(o||o===0)s+=o;s+=" ",o=n["if"].call(t,t.rev,{hash:{},inverse:l.noop,fn:l.program(3,h,i),data:i});if(o||o===0)s+=o;s+=" ",o=n["if"].call(t,t.rel,{hash:{},inverse:l.noop,fn:l.program(5,p,i),data:i});if(o||o===0)s+=o;s+=" ",o=n["if"].call(t,t.type,{hash:{},inverse:l.noop,fn:l.program(7,d,i),data:i});if(o||o===0)s+=o;s+=" ",o=n["if"].call(t,t.media,{hash:{},inverse:l.noop,fn:l.program(9,v,i),data:i});if(o||o===0)s+=o;s+=" ",o=n["if"].call(t,t.href,{hash:{},inverse:l.noop,fn:l.program(11,m,i),data:i});if(o||o===0)s+=o;s+=" ",o=n["if"].call(t,t.addedBy,{hash:{},inverse:l.noop,fn:l.program(13,g,i),data:i});if(o||o===0)s+=o;return s+=' data-dynamic="true" />',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/head-link",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("pagination-view",function(e){e.namespace("Views")[this.name]=e.Base.create("pagination-view",e.FlickrView,[],{initializer:function(e){return this.modelKey=e.pageParams&&e.pageParams.idAttribute?e[e.pageParams.idAttribute]:e.nsid,this.baseURL=e.baseURL.replace(/\/with\/[0-9]+/,""),this.modelRegistryName=e.modelRegistryName,this.maxNumAttrName=e.maxNumAttrName||"totalItems",this.pageParams=e.pageParams,this.fetchParams=e.fetchParams||{},this.maxResults=e.maxResults||!1,this.paginationSuffix=e.paginationSuffix||"",this.hideMorePages=e.hideMorePages||!1,e.numMaxContiguousPages&&this.set("numMaxContiguousPages",e.numMaxContiguousPages),e.numStartEndPages&&this.set("numStartEndPages",e.numStartEndPages),this.appContext.getUA().isMobileBrowser&&this.set("numMaxContiguousPages",3),this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var e=this,t;return this.appContext.getModel(this.modelRegistryName,this.modelKey,this.fetchParams).then(function(n){e.model=n,e.numPages=Math.ceil(e.model.getValue(e.maxNumAttrName)/e.pageParams.viewPageSize),e.registerEventHandler(e.model.on("valuesChanged",function(n){e.maxResults&&e.model.getValue("totalItems")>e.maxResults&&e.model.setValue("totalItems",e.maxResults),n[e.maxNumAttrName]&&(t=Math.ceil(n[e.maxNumAttrName].newVal/e.pageParams.viewPageSize),t!==e.numPages&&(e.numPages=t,e.buildContainer()))}))})},buildContainer:function(){var e=[],t=this.baseURL+"page",n,r,i;return i=this.getPaginationURLs(),r=i.nextURL,n=i.prevURL,e=this.calcPages(t,i.getParamsInUrl),this.setContainerHTML(this.templates("pagination-view")({leftUrl:n,rightUrl:r,pages:e,hide:e.length===1})),this},buildHeadContainer:function(){var e,t,n,r,i="";if(!this.pageParams.nominalPage)return;r=this.getPaginationURLs(),e=r.canonicalURL,t=r.nextURL,n=r.prevURL,i+=this.templates("head-link")({rel:"canonical",href:e}),n&&(i+=this.templates("head-link")({rel:"prev",href:n})),t&&(i+=this.templates("head-link")({rel:"next",href:t})),this.set("headContainer",i),YUI.Env.isServer||this.updateHead()},getPaginationURLs:function(){var t=this.baseURL,n,r,i,s;return YUI.Env.isServer?this.paginationSuffix&&(s=this.paginationSuffix):s=e.config.win.location.search,s||(s=""),n=t+s,this.pageParams.nominalPage>1&&this.numPages>1&&(i=t+"page"+(this.pageParams.nominalPage-1).toString()+"/"+s),this.pageParams.nominalPage<this.numPages&&this.numPages>1&&(r=t+"page"+(this.pageParams.nominalPage+1).toString()+"/"+s),{canonicalURL:n,nextURL:r,prevURL:i,getParamsInUrl:s}},activate:function(){return this.registerEventHandler(e.globalEvents.subscribe("window:resize",this.handlePageResize.bind(this))),this},handlePageResize:function(){var t=e.config.win.innerWidth,n=this.get("numMaxContiguousPages"),r;t<=700?r=3:r=7,n!==r&&(this.set("numMaxContiguousPages",r),this.buildContainer())},calcPages:function(e,t){function u(r){var i=(r+1).toString(),s=n.pageParams.nominalPage===r+1,o=n.pageParams.nominalPage===r,u=n.pageParams.nominalPage===r+2;return{url:e+i+t,text:i,isMore:!1,isCurrent:s,rel:u?"prev":o?"next":null}}var n=this,r=[],i,s=this.get("numMaxContiguousPages"),o=this.get("numStartEndPages");if(this.numPages<=s)for(i=0;i<this.numPages;i++)r.push(u(i));else if(this.pageParams.nominalPage<=s-1){for(i=0;i<s;i++)r.push(u(i));if(!this.hideMorePages){this.numPages>s+o&&r.push({isMore:!0});for(i=Math.max(s,this.numPages-o);i<this.numPages;i++)r.push(u(i))}}else if(this.pageParams.nominalPage>this.numPages-(s-1)){if(!this.hideMorePages){for(i=0;i<Math.min(this.numPages-s,o);i++)r.push(u(i));this.numPages>s+o&&r.push({isMore:!0})}for(i=this.numPages-s;i<this.numPages;i++)r.push(u(i))}else{if(!this.hideMorePages){for(i=0;i<o;i++)r.push(u(i));r.push({isMore:!0})}for(i=this.pageParams.nominalPage-Math.ceil(s/2);i<this.pageParams.nominalPage+Math.floor(s/2);i++)r.push(u(i));if(!this.hideMorePages){r.push({isMore:!0});for(i=this.numPages-o;i<this.numPages;i++)r.push(u(i))}}return r}},{ATTRS:{numMaxContiguousPages:{value:7},numStartEndPages:{value:2}}})},"@VERSION@",{requires:["flickr-view","hermes-template-pagination-view","hermes-template-head-link","pagination-view-css"],optional:[]});
YUI.add("hermes-template-fluid-coverphoto",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var n="",r;return n+='style="background-image:url('+l((r=(r=(r=e.coverPhoto,r==null||r===!1?r:r.urls),r==null||r===!1?r:r.h),typeof r===f?r.apply(e):r))+')"',n}function d(e,t){var r="",i,s;return r+='\n			<div class="cover-photo-edit" title="',s={hash:{intlName:"header.EDIT_COVER_PHOTO"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+'" data-action="pick" data-track="headerEditCoverPhotoClick"></div>\n		',r}function v(e,t){var r="",i,s;return r+='\n			<div class="cover-photo-attribution"><a href="/photos/'+l((i=(i=(i=(i=e.coverPhoto,i==null||i===!1?i:i.attribution),i==null||i===!1?i:i.owner),i==null||i===!1?i:i.nsid),typeof i===f?i.apply(e):i))+"/"+l((i=(i=(i=e.coverPhoto,i==null||i===!1?i:i.attribution),i==null||i===!1?i:i.id),typeof i===f?i.apply(e):i))+'">',s={hash:{intlName:"groups.GROUPS_COVER_ATTRIBUTION",username:(i=(i=(i=e.coverPhoto,i==null||i===!1?i:i.attribution),i==null||i===!1?i:i.owner),i==null||i===!1?i:i.characterName)},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+" </a></div>\n		",r}function m(e,t){var r="",i,s;r+='\n			<div class="avatar no-menu '+l((i=(i=e.avatar,i==null||i===!1?i:i.type),typeof i===f?i.apply(e):i))+" large ",s=n.unless.call(e,(i=e.avatar,i==null||i===!1?i:i.canEdit),{hash:{},inverse:h.noop,fn:h.program(8,g,t),data:t});if(s||s===0)r+=s;r+='" style="background-image: url('+l((i=(i=(i=e.avatar,i==null||i===!1?i:i.icon),i==null||i===!1?i:i.retina),typeof i===f?i.apply(e):i))+');">\n				',s=n["if"].call(e,(i=e.avatar,i==null||i===!1?i:i.canEdit),{hash:{},inverse:h.noop,fn:h.program(10,y,t),data:t});if(s||s===0)r+=s;return r+='\n				<div class="loading-overlay">\n					<div class="balls"></div>\n				</div>\n			</div>\n		',r}function g(e,t){return"no-edit"}function y(e,t){return'\n					<div class="edit" data-action="editAvatar" data-track="headerBuddyIconClick">\n						<span class="edit-icon"></span>\n					</div>\n				'}function b(e,t){var r="",i,s;r+='\n			<div class="avatar no-menu '+l((i=(i=e.avatar,i==null||i===!1?i:i.type),typeof i===f?i.apply(e):i))+' large" style="background-image: url('+l((i=(i=(i=e.avatar,i==null||i===!1?i:i.icon),i==null||i===!1?i:i.lowres),typeof i===f?i.apply(e):i))+');">\n				',s=n["if"].call(e,(i=e.avatar,i==null||i===!1?i:i.canEdit),{hash:{},inverse:h.noop,fn:h.program(10,y,t),data:t});if(s||s===0)r+=s;return r+='\n				<div class="loading-overlay">\n					<div class="balls"></div>\n				</div>\n			</div>\n		',r}function w(e,t){var r="",i,s;r+='\n				<div class="title">\n					',s=n["if"].call(e,(i=e.titleBlock,i==null||i===!1?i:i.titleLink),{hash:{},inverse:h.program(20,T,t),fn:h.program(15,E,t),data:t});if(s||s===0)r+=s;r+="\n					",s=n["if"].call(e,(i=e.titleBlock,i==null||i===!1?i:i.follow),{hash:{},inverse:h.noop,fn:h.program(25,k,t),data:t});if(s||s===0)r+=s;r+="\n					",s=n["if"].call(e,e["follow-view"],{hash:{},inverse:h.noop,fn:h.program(27,L,t),data:t});if(s||s===0)r+=s;r+="\n					",s=n["if"].call(e,(i=e.titleBlock,i==null||i===!1?i:i.curatorPassOver),{hash:{},inverse:h.noop,fn:h.program(29,A,t),data:t});if(s||s===0)r+=s;r+="\n				</div>\n\n				",s=n["if"].call(e,(i=e.titleBlock,i==null||i===!1?i:i.isPro),{hash:{},inverse:h.noop,fn:h.program(31,O,t),data:t});if(s||s===0)r+=s;r+="\n\n				",s=n["if"].call(e,(i=e.titleBlock,i==null||i===!1?i:i.subtitle),{hash:{},inverse:h.noop,fn:h.program(33,M,t),data:t});if(s||s===0)r+=s;return r+="\n			",r}function E(e,t){var r="",i,s;r+='\n						<h1 class="truncate">\n							<a class="unfluid" href="'+l((i=(i=e.titleBlock,i==null||i===!1?i:i.titleLink),typeof i===f?i.apply(e):i))+'">\n								',s=n["if"].call(e,(i=e.titleBlock,i==null||i===!1?i:i.isGroup),{hash:{},inverse:h.program(18,x,t),fn:h.program(16,S,t),data:t});if(s||s===0)r+=s;return r+="\n							</a>\n						</h1>\n					",r}function S(e,t){var r="",i,s;return r+="\n									",s={hash:{},data:t},r+=l((i=n.renderTrustedMarkup||e.renderTrustedMarkup,i?i.call(e,(i=e.titleBlock,i==null||i===!1?i:i.title),s):c.call(e,"renderTrustedMarkup",(i=e.titleBlock,i==null||i===!1?i:i.title),s)))+"\n								",r}function x(e,t){var n="",r;return n+="\n									"+l((r=(r=e.titleBlock,r==null||r===!1?r:r.title),typeof r===f?r.apply(e):r))+"\n								",n}function T(e,t){var r="",i,s;r+='\n						<h1 class="truncate">\n							',s=n["if"].call(e,(i=e.titleBlock,i==null||i===!1?i:i.isGroup),{hash:{},inverse:h.program(23,C,t),fn:h.program(21,N,t),data:t});if(s||s===0)r+=s;return r+="\n						</h1>\n					",r}function N(e,t){var r="",i,s;return r+="\n								",s={hash:{},data:t},r+=l((i=n.renderTrustedMarkup||e.renderTrustedMarkup,i?i.call(e,(i=e.titleBlock,i==null||i===!1?i:i.title),s):c.call(e,"renderTrustedMarkup",(i=e.titleBlock,i==null||i===!1?i:i.title),s)))+"\n							",r}function C(e,t){var n="",r;return n+="\n								"+l((r=(r=e.titleBlock,r==null||r===!1?r:r.title),typeof r===f?r.apply(e):r))+"\n							",n}function k(e,t){var r,i;return i={hash:{},data:t},l((r=n.outlet||e.outlet,r?r.call(e,(r=e.titleBlock,r==null||r===!1?r:r.follow),i):c.call(e,"outlet",(r=e.titleBlock,r==null||r===!1?r:r.follow),i)))}function L(e,t){var r,i;return i={hash:{},data:t},l((r=n.outlet||e.outlet,r?r.call(e,e["follow-view"],i):c.call(e,"outlet",e["follow-view"],i)))}function A(e,t){var r,i;return i={hash:{},data:t},l((r=n.outlet||e.outlet,r?r.call(e,(r=e.titleBlock,r==null||r===!1?r:r.curatorPassOver),i):c.call(e,"outlet",(r=e.titleBlock,r==null||r===!1?r:r.curatorPassOver),i)))}function O(e,t){return'\n					<a href="/account/upgrade/pro" class="pro-badge-inline dark">PRO</a>\n				'}function M(e,t){var n="",r;return n+='\n					<p class="subtitle truncate">'+l((r=(r=e.titleBlock,r==null||r===!1?r:r.subtitle),typeof r===f?r.apply(e):r))+"</p>\n				",n}function _(e,t){var r="",i;r+="\n				",i=n["if"].call(e,e.contacts,{hash:{},inverse:h.noop,fn:h.program(36,D,t),data:t
});if(i||i===0)r+=i;r+="\n				",i=n["if"].call(e,e.groupsStats,{hash:{},inverse:h.noop,fn:h.program(44,F,t),data:t});if(i||i===0)r+=i;return r+="\n			",r}function D(e,t){var r="",i;r+="\n					",i=n["if"].call(e,e.viewingSelf,{hash:{},inverse:h.program(39,H,t),fn:h.program(37,P,t),data:t});if(i||i===0)r+=i;return r+="\n				",r}function P(e,t){var r="",i;return r+='\n						<p class="followers truncate"><a href="',(i=n.followerUrl)?i=i.call(e,{hash:{},data:t}):(i=e.followerUrl,i=typeof i===f?i.apply(e):i),r+=l(i)+'">',(i=n.followerString)?i=i.call(e,{hash:{},data:t}):(i=e.followerString,i=typeof i===f?i.apply(e):i),r+=l(i)+'</a><em>&bull;</em><a href="',(i=n.followingUrl)?i=i.call(e,{hash:{},data:t}):(i=e.followingUrl,i=typeof i===f?i.apply(e):i),r+=l(i)+'">',(i=n.followingString)?i=i.call(e,{hash:{},data:t}):(i=e.followingString,i=typeof i===f?i.apply(e):i),r+=l(i)+"</a></p>\n					",r}function H(e,t){var r="",i,s,o;r+="\n						",o={hash:{},inverse:h.program(42,j,t),fn:h.program(40,B,t),data:t},s=(i=n.ifCond||e.ifCond,i?i.call(e,e.followingCount,">",0,o):c.call(e,"ifCond",e.followingCount,">",0,o));if(s||s===0)r+=s;return r+="\n					",r}function B(e,t){var r="",i;return r+='\n							<p class="followers truncate">',(i=n.followerString)?i=i.call(e,{hash:{},data:t}):(i=e.followerString,i=typeof i===f?i.apply(e):i),r+=l(i)+'<em>&bull;</em><a href="',(i=n.followingUrl)?i=i.call(e,{hash:{},data:t}):(i=e.followingUrl,i=typeof i===f?i.apply(e):i),r+=l(i)+'">',(i=n.followingString)?i=i.call(e,{hash:{},data:t}):(i=e.followingString,i=typeof i===f?i.apply(e):i),r+=l(i)+"</a></p>\n						",r}function j(e,t){var r="",i;return r+='\n							<p class="followers truncate">',(i=n.followerString)?i=i.call(e,{hash:{},data:t}):(i=e.followerString,i=typeof i===f?i.apply(e):i),r+=l(i)+"<em>&bull;</em>",(i=n.followingString)?i=i.call(e,{hash:{},data:t}):(i=e.followingString,i=typeof i===f?i.apply(e):i),r+=l(i)+"</p>\n						",r}function F(e,t){var r="",i,s,o;return r+='\n					<p class="followers truncate"><a href="',(i=n.membersLink)?i=i.call(e,{hash:{},data:t}):(i=e.membersLink,i=typeof i===f?i.apply(e):i),r+=l(i)+'">',(i=n.members)?i=i.call(e,{hash:{},data:t}):(i=e.members,i=typeof i===f?i.apply(e):i),r+=l(i)+" ",o={hash:{intlName:"header.MEMBERS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,o):c.call(e,"intlMessage",o)))+'</a><em>&bull;</em></p>\n					<p class="followers truncate"><a href="',(s=n.poolLink)?s=s.call(e,{hash:{},data:t}):(s=e.poolLink,s=typeof s===f?s.apply(e):s),r+=l(s)+'">',(s=n.photosText)?s=s.call(e,{hash:{},data:t}):(s=e.photosText,s=typeof s===f?s.apply(e):s),r+=l(s)+'</a><em>&bull;</em></p>\n					<p class="followers truncate"><a href="',(s=n.discussionsLink)?s=s.call(e,{hash:{},data:t}):(s=e.discussionsLink,s=typeof s===f?s.apply(e):s),r+=l(s)+'"> ',(s=n.topicCount)?s=s.call(e,{hash:{},data:t}):(s=e.topicCount,s=typeof s===f?s.apply(e):s),r+=l(s)+" ",o={hash:{intlName:"header.DISCUSSIONS"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,o):c.call(e,"intlMessage",o)))+"</a></p>\n				",r}function I(e,t){var r="",i;r+="\n				",i=n["if"].call(e,e.hasLocation,{hash:{},inverse:h.noop,fn:h.program(47,q,t),data:t});if(i||i===0)r+=i;r+="\n				",i=n["if"].call(e,e.photos,{hash:{},inverse:h.noop,fn:h.program(49,R,t),data:t});if(i||i===0)r+=i;r+="\n				",i=n["if"].call(e,e.memberSince,{hash:{},inverse:h.noop,fn:h.program(51,U,t),data:t});if(i||i===0)r+=i;r+="\n				",i=n["if"].call(e,e.groupSince,{hash:{},inverse:h.noop,fn:h.program(53,z,t),data:t});if(i||i===0)r+=i;return r+="\n			",r}function q(e,t){var r="",i;return r+='<p class="truncate">',(i=n.location)?i=i.call(e,{hash:{},data:t}):(i=e.location,i=typeof i===f?i.apply(e):i),r+=l(i)+"</p>",r}function R(e,t){var r="",i,s;return r+='<p class="photo-count">',s={hash:{intlName:"header.COUNT_PHOTOS",count:e.count},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+"</p>",r}function U(e,t){var r="",i,s;return r+="<p>",s={hash:{intlName:"header.JOINED_YEAR",year:e.date},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+"</p>",r}function z(e,t){var r="",i,s;return r+="<p>",(i=n.count)?i=i.call(e,{hash:{},data:t}):(i=e.count,i=typeof i===f?i.apply(e):i),r+=l(i)+" ",s={hash:{intlName:"header.GROUP_SINCE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+" ",s={hash:{intlName:"header.MDY_DATE",mdyDate:e.date},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+"</p>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing,h=this;s+='<div class="coverphoto" ',o=n["if"].call(t,t.coverPhoto,{hash:{},inverse:h.noop,fn:h.program(1,p,i),data:i});if(o||o===0)s+=o;s+='>\n	<div class="editor-controls">\n		<button data-action="saveEdit" class="butt">',a={hash:{intlName:"common.SAVE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</button>\n		<button data-action="cancelEdit" class="butt alt">',a={hash:{intlName:"common.CANCEL"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+"</button>\n		<p>",a={hash:{intlName:"header.COVER_PHOTO_SET_POSITION"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</p>\n	</div>\n	<div class="balls"></div>\n	<div class="coverphoto-gradient">\n	</div>\n	<div class="coverphoto-content fluid-centered">\n		',u=n["if"].call(t,(o=t.coverPhoto,o==null||o===!1?o:o.canEdit),{hash:{},inverse:h.noop,fn:h.program(3,d,i),data:i});if(u||u===0)s+=u;s+="\n		",u=n["if"].call(t,(o=(o=t.coverPhoto,o==null||o===!1?o:o.attribution),o==null||o===!1?o:o.id),{hash:{},inverse:h.noop,fn:h.program(5,v,i),data:i});if(u||u===0)s+=u;s+="\n\n		",u=n["if"].call(t,(o=(o=t.avatar,o==null||o===!1?o:o.icon),o==null||o===!1?o:o.retina),{hash:{},inverse:h.program(12,b,i),fn:h.program(7,m,i),data:i});if(u||u===0)s+=u;s+='\n		<div class="title-block-content">\n			'
,u=n["if"].call(t,t.titleBlock,{hash:{},inverse:h.noop,fn:h.program(14,w,i),data:i});if(u||u===0)s+=u;s+="\n\n			\n			",u=n.each.call(t,t.metadata,{hash:{},inverse:h.noop,fn:h.program(35,_,i),data:i});if(u||u===0)s+=u;s+='\n		</div>\n\n		\n		<div class="metadata-content">\n			',u=n.each.call(t,t.metadata,{hash:{},inverse:h.noop,fn:h.program(46,I,i),data:i});if(u||u===0)s+=u;return s+="\n		</div>\n	</div>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-coverphoto",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-follow",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){var r="",i;r+="\n	",i=n["if"].call(e,e.showNoButton,{hash:{},inverse:a.program(4,h,t),fn:a.program(2,c,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function c(e,t){var n="";return n+="\n		\n	",n}function h(e,t){var r="",i;r+="\n		",i=n["if"].call(e,e.showUnblockButton,{hash:{},inverse:a.program(7,d,t),fn:a.program(5,p,t),data:t});if(i||i===0)r+=i;return r+="\n	",r}function p(e,t){var r="",i,s;return r+="\n			<button class='follow alt'>",s={hash:{intlName:"common.UNBLOCK"},data:t},r+=u((i=n.intlMessage||e.intlMessage,i?i.call(e,s):o.call(e,"intlMessage",s)))+"</button>\n		",r}function d(e,t){var r="",i;r+="\n			",i=n["if"].call(e,e.showFollowingButton,{hash:{},inverse:a.program(10,m,t),fn:a.program(8,v,t),data:t});if(i||i===0)r+=i;return r+="\n		",r}function v(e,t){return'\n				<button class="follow is-following mini"><span class="drop-icon">\u25be</span></button>\n			'}function m(e,t){return'\n				<button class="follow mini"></button>\n			'}function g(e,t){var r="",i;r+="\n	",i=n["if"].call(e,e.isFluid,{hash:{},inverse:a.program(25,C,t),fn:a.program(13,y,t),data:t});if(i||i===0)r+=i;r+="\n	",i=n["if"].call(e,e.curationEnrollmentStatus,{hash:{},inverse:a.noop,fn:a.program(34,_,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function y(e,t){var r="",i;r+="\n		",i=n["if"].call(e,e.showNoButton,{hash:{},inverse:a.program(16,w,t),fn:a.program(14,b,t),data:t});if(i||i===0)r+=i;return r+="\n	",r}function b(e,t){var n="";return n+="\n			\n		",n}function w(e,t){var r="",i;r+="\n			",i=n["if"].call(e,e.showUnblockButton,{hash:{},inverse:a.program(19,S,t),fn:a.program(17,E,t),data:t});if(i||i===0)r+=i;return r+="\n		",r}function E(e,t){var r="",i,s;return r+="\n				<button class='follow alt'>",s={hash:{intlName:"common.UNBLOCK"},data:t},r+=u((i=n.intlMessage||e.intlMessage,i?i.call(e,s):o.call(e,"intlMessage",s)))+"</button>\n			",r}function S(e,t){var r="",i;r+="\n				",i=n["if"].call(e,e.showFollowingButton,{hash:{},inverse:a.program(23,N,t),fn:a.program(20,x,t),data:t});if(i||i===0)r+=i;return r+="\n			",r}function x(e,t){var r="",i,s;r+='\n					<button class="follow is-following ',i=n["if"].call(e,e.isOnDark,{hash:{},inverse:a.noop,fn:a.program(21,T,t),data:t});if(i||i===0)r+=i;return r+='">',s={hash:{intlName:e.followingIntlKey},data:t},r+=u((i=n.intlMessage||e.intlMessage,i?i.call(e,s):o.call(e,"intlMessage",s)))+'<span class="drop-icon">\u25be</span></button>\n				',r}function T(e,t){return"white"}function N(e,t){var r="",i,s;r+='\n					<button class="follow ',i=n["if"].call(e,e.isOnDark,{hash:{},inverse:a.noop,fn:a.program(21,T,t),data:t});if(i||i===0)r+=i;return r+='">',s={hash:{intlName:e.followIntlKey},data:t},r+=u((i=n.intlMessage||e.intlMessage,i?i.call(e,s):o.call(e,"intlMessage",s)))+"</button>\n				",r}function C(e,t){var r="",i;r+="\n		",i=n["if"].call(e,e.showNoButton,{hash:{},inverse:a.program(26,k,t),fn:a.program(14,b,t),data:t});if(i||i===0)r+=i;return r+="\n	",r}function k(e,t){var r="",i;r+='\n			<span class="relationship">\n				',i=n["if"].call(e,e.showUnblockButton,{hash:{},inverse:a.program(29,A,t),fn:a.program(27,L,t),data:t});if(i||i===0)r+=i;return r+="\n			</span>\n		",r}function L(e,t){var n="";return n+="\n					\n				",n}function A(e,t){var r="",i;r+="\n					",i=n["if"].call(e,e.showFollowingButton,{hash:{},inverse:a.program(32,M,t),fn:a.program(30,O,t),data:t});if(i||i===0)r+=i;return r+="\n				",r}function O(e,t){var r="",i,s;return r+="\n						<button class='unfluid follow is-following ui-button ui-button-icon ui-button-transparent ui-button-dropdown'><span>",s={hash:{intlName:"common.FOLLOWING"},data:t},r+=u((i=n.intlMessage||e.intlMessage,i?i.call(e,s):o.call(e,"intlMessage",s)))+"</span></button>\n					",r}function M(e,t){var r="",i,s;return r+="\n						<button class='unfluid follow ui-button ui-button-icon'><span>",s={hash:{intlName:"common.FOLLOW"},data:t},r+=u((i=n.intlMessage||e.intlMessage,i?i.call(e,s):o.call(e,"intlMessage",s)))+"</span></button>\n					",r}function _(e,t){var r="",i;return r+="<h3 class='curation-enrollment-status'>[",(i=n.curationEnrollmentStatus)?i=i.call(e,{hash:{},data:t}):(i=e.curationEnrollmentStatus,i=typeof i===f?i.apply(e):i),r+=u(i)+"]</h3>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s,o=n.helperMissing,u=this.escapeExpression,a=this,f="function";return s=n["if"].call(t,t.isOnMobile,{hash:{},inverse:a.program(12,g,i),fn:a.program(1,l,i),data:i}),s||s===0?s:""}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/follow",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-following-dropdown",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){return'\n			<label class = "checked">\n				<input type="checkbox" checked="checked" id="friend-checkbox" />\n		'}function p(e,t){return'\n			<label>\n				<input type="checkbox" id="friend-checkbox" />\n		'}function d(e,t){return'\n			<label class="checked">\n				<input type="checkbox" checked="checked" id="family-checkbox" />\n		'}function v(e,t){return'\n			<label>\n				<input type="checkbox" id="family-checkbox" />\n		'}function m(e,t){var r="",i,s;return r+='\n			<button class="follow unfollow">',s={hash:{intlName:"common.UNFOLLOW"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"</button>\n		",r}function g(e,t){var r="",i,s;return r+='\n			<a href="#"><i class="ui-icon-tiny-unfollow"></i> ',s={hash:{intlName:"common.UNFOLLOW"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"</a>\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f=n.helperMissing,l=this.escapeExpression,c=this;s+='<ul>\n	<li class="following-friend">\n		',o=n["if"].call(t,t.isFriend,{hash:{},inverse:c.program(3,p,i),fn:c.program(1,h,i),data:i});if(o||o===0)s+=o;s+="\n			",a={hash:{intlName:"common.FRIEND"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+'\n		</label>\n	</li>\n	<li class="following-family">\n		',u=n["if"].call(t,t.isFamily,{hash:{},inverse:c.program(7,v,i),fn:c.program(5,d,i),data:i});if(u||u===0)s+=u;s+="\n			",a={hash:{intlName:"common.FAMILY"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+'\n		</label>\n	</li>\n	<li class="divider"></li>\n	<li class="following-unfollow">\n		',u=n["if"].call(t,t.isFluid,{hash:{},inverse:c.program(11,g,i),fn:c.program(9,m,i),data:i});if(u||u===0)s+=u;return s+="\n	</li>\n</ul>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/following-dropdown",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("relationship-menu-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.nsid=e.nsid,this.pathAlias=e.pathAlias,this.disableRefreshOnRelationshipChange=e.disableRefreshOnRelationshipChange,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var e=this,t=e.nsid||{pathAlias:e.pathAlias};return e.appContext.getModel("person-relationship-models",t).then(function(t){e.relationship=t,e.nsid=e.nsid||t.id})},buildContainer:function(){return this.setContainerHTML(this.templates("following-dropdown")({isFriend:this.relationship.getValue("isFriend"),isFamily:this.relationship.getValue("isFamily"),isFluid:!0})),this},activate:function(){var e=this.get("container"),t=this;return this.registerEventHandler(this.relationship.on("valuesChanged",function(){t.buildContainer()})),this.registerEventHandler(e.delegate("click",function(e){t.handleUnfollowClick(e)},".following-unfollow")),this.registerEventHandler(e.delegate("change",function(e){t.handleFriendChange(e)},".following-friend input")),this.registerEventHandler(e.delegate("change",function(e){t.handleFamilyChange(e)},".following-family input")),this},handleUnfollowClick:function(t){var n=this;t.preventDefault(),this.relationship.getValue("isContact")&&(this.relationship.registry.toggleFollowing(this.nsid),this.relationship.registry.remoteUpdate(this.nsid).then(function(){n.disableRefreshOnRelationshipChange||(e.config.win.location=e.config.win.location)},function(t){n.relationship.setValue("isContact",!0),n.buildContainer(),e.Flog.error(t)}),e.rapidTracker.beacon(this.name,"unfollowButtonClick"),this.fire("onUnfollow"))},handleFriendChange:function(t){var n=this;this.relationship.registry.toggleFriend(this.nsid),this.relationship.registry.remoteUpdate(this.nsid).then(function(){n.disableRefreshOnRelationshipChange||(e.config.win.location=e.config.win.location)},function(t){n.relationship.registry.toggleFriend(n.nsid),n.buildContainer(),n.onError(n.intlMessage({intlName:"person.RELATIONSHIP_FRIEND_ERROR"})),e.Flog.error(t)})},handleFamilyChange:function(t){var n=this;this.relationship.registry.toggleFamily(this.nsid),this.relationship.registry.remoteUpdate(this.nsid).then(function(){n.disableRefreshOnRelationshipChange||(e.config.win.location=e.config.win.location)},function(t){n.relationship.registry.toggleFamily(n.nsid),n.buildContainer(),n.onError(n.intlMessage({intlName:"person.RELATIONSHIP_FAMILY_ERROR"})),e.Flog.error(t)})}})},"@VERSION@",{requires:["promise","flog","fluid-css","hermes-template-following-dropdown","relationship-menu-css"],langBundles:["common","person"]});
YUI.add("flickr-contacts-add-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.contacts.add",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-contacts-add"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-contacts-remove-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.contacts.remove",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-contacts-remove"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-contacts-edit-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.contacts.edit",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-contacts-edit"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-contacts-block-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.contacts.block",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-contacts-block"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-contacts-unblock-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.contacts.unblock",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-contacts-unblock"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-prefs-setSafeSearch-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.prefs.setSafeSearch",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-prefs-setSafeSearch"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("person-preferences-models",function(e){function t(e){t.superclass.constructor.call(this,e)}t.UNIFIED_SEARCH_VIEW_TYPES={justified:"jst",thumbs:"thm",tiles:"til"},t.UNIFIED_SEARCH_VIEW_TYPE_DEFAULT=t.UNIFIED_SEARCH_VIEW_TYPES.justified,t.PHOTOSTREAM_VIEW_ORDER_TYPES={dateposted:"dc",datetaken:"dt"},t.PHOTOSTREAM_VIEW_ORDER_DEFAULT=t.PHOTOSTREAM_VIEW_ORDER_TYPES.dateposted,t.PHOTOSTREAM_VIEW_AS_TYPES={me:"me",friend:"fr",family:"fa",ff:"ff","public":"pu"},t.PHOTOSTREAM_VIEW_PREF_MAP={me:"me",fr:"friend",fa:"family",ff:"ff",pu:"public",dc:"dateposted",dt:"datetaken"},t.ALBUM_VIEW_LAYOUT_TYPES={justified:"justified",story:"story"},t.ALBUM_VIEW_LAYOUT_DEFAULT=t.ALBUM_VIEW_LAYOUT_TYPES.story,t.PHOTOSTREAM_VIEW_AS_DEFAULT=t.PHOTOSTREAM_VIEW_AS_TYPES.public,e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,n){var r=[],i={};return e.Lang.isObject(n,!0)&&("safeSearch"in n?(i.safe_search=e.AttributeHelpers.coerceInteger(n.safeSearch.newVal)+1,r.push(e.ModelUpdaters["flickr-prefs-setSafeSearch"].run(i,this.appContext))):"photostreamViewOrderPref"in n||"photostreamViewAsPref"in n?(n.photostreamViewOrderPref&&(i.photostream_view_order_pref=n.photostreamViewOrderPref.newVal),n.photostreamViewAsPref&&(i.photostream_view_as_pref=n.photostreamViewAsPref.newVal),r.push(this.appContext.callAPI("flickr.prefs.setPrefs",i))):"albumViewLayoutPref"in n?(n.albumViewLayoutPref&&(i.album_view_layout=n.albumViewLayoutPref.newVal),r.push(this.appContext.callAPI("flickr.prefs.setPrefs",i))):Object.keys(n).forEach(function(e){e==="unifiedSearchViewPref"?i.unified_search_view_pref=n.unifiedSearchViewPref.newVal:i[e]=n[e],r.push(this.appContext.callAPI("flickr.prefs.setPrefs",i))})),e.Promise.all(r)}},attributes:{safeSearch:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},unifiedSearchViewPref:{validator:function(n){return e.AttributeHelpers.validateString(n)?Object.keys(t.UNIFIED_SEARCH_VIEW_TYPES).some(function(e){return t.UNIFIED_SEARCH_VIEW_TYPES[e]===n}):!1},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.UNIFIED_SEARCH_VIEW_TYPE_DEFAULT},photostreamViewOrderPref:{validator:function(n){return e.AttributeHelpers.validateString(n)?Object.keys(t.PHOTOSTREAM_VIEW_ORDER_TYPES).some(function(e){return t.PHOTOSTREAM_VIEW_ORDER_TYPES[e]===n}):!1},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.PHOTOSTREAM_VIEW_ORDER_DEFAULT},photostreamViewAsPref:{validator:function(n){return e.AttributeHelpers.validateString(n)?Object.keys(t.PHOTOSTREAM_VIEW_AS_TYPES).some(function(e){return t.PHOTOSTREAM_VIEW_AS_TYPES[e]===n}):!1},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.PHOTOSTREAM_VIEW_AS_DEFAULT},albumViewLayoutPref:{validator:function(n){return e.AttributeHelpers.validateString(n)?Object.keys(t.ALBUM_VIEW_LAYOUT_TYPES).some(function(e){return t.ALBUM_VIEW_LAYOUT_TYPES[e]===n}):!1},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:t.ALBUM_VIEW_LAYOUT_DEFAULT}}},{getReadablePrefName:function(e){return t.PHOTOSTREAM_VIEW_PREF_MAP[e]}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-prefs-setSafeSearch-updater","attribute-helpers"]});
YUI.add("person-profile-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)}},attributes:{nsid:{readOnly:!0,defaultFn:function(e){return e}},photoCount:{},unreadMessages:{},storageUsed:{},storageTotal:{},coverPhotoUrls:{},location:{}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher"]});
YUI.add("flickr-groups-join-creator",function(e,t){"use strict";function n(n,r){var i={};return i.group_id=n.groupModel.id,i.accept_rules=n.acceptRules,e.Promise.all([r.callAPI("flickr.groups.join",i)]).then(function(e){var t=e[0];if(t.stat==="ok")return n.groupModel.join(),n.groupModel},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-groups-join"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("flickr-groups-leave-deletor",function(e,t){"use strict";function n(n,r){var i={};return i.group_id=n.groupModel.id,i.delete_photos=n.deletePhotos,e.Promise.all([r.callAPI("flickr.groups.leave",i)]).then(function(e){var t=e[0];if(t.stat==="ok")return n.groupModel.leave(),n.groupModel},e.FetcherErrorLogger(t))}e.namespace("ModelDeletors")["flickr-groups-leave"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("group-info-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-groups-getInfo"].run(t,this.appContext)},join:function(t,n){return e.ModelCreators["flickr-groups-join"].run(t,n)},leave:function(t,n){return e.ModelDeletors["flickr-groups-leave"].run(t,n)}},join:function(e){var t=this.getValue(e,"group");return t&&t.setValue("isMember",!0),this},leave:function(e){var t=this.getValue(e,"group");return t&&(t.setValue("isAdmin",!1),t.setValue("isModerator",!1),t.setValue("isMember",!1),this.setValue(e,"hasPendingInvite",!1)),this},attributes:{pathAlias:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},description:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},secureDescription:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},rules:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},roles:{},secureRules:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},hasPendingInvite:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},discussionsLocked:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},privacy:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:1},restrictions:{},throttle:{},poolPreviewRowsVisibleCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return 1}},coverPhotoAttribution:{},group:{isModel:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-groups-getInfo-fetcher","flickr-groups-join-creator","flickr-groups-leave-deletor","attribute-helpers","group-models"]});
YUI.add("flickr-groups-getInfo-fetcher",function(e,t){"use strict";function n(t){var n={extras:e.APIHelper.request.getRebootPhotoExtras()+","+e.APIHelper.request.getRebootGroupExtras()+", blast_user_info, date_last_viewed, has_pending_invite, coverphoto_attribution, is_locked",secure_image_embeds:1,lang:undefined};if(t.id)n.group_id=t.id;else{if(!t.pathAlias)throw new Error("[flickr-groups-getInfo-fetcher] `id` or `pathAlias` is required.");n.group_path_alias=t.pathAlias}return n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a,f,l,c;return l=s.parseGroupModel(n.id,n.pathAlias,r.group),s.addOrUpdate(l),f={id:l.id,viewedPool:e.moment(r.group.viewedDates?r.group.viewedDates.pool:undefined),viewedDiscussions:e.moment(r.group.viewedDates?r.group.viewedDates.discussions:undefined),group:s.proxy(l.id)},u.addOrUpdate(f),l=s.proxy(l.id),c={id:l.id,blastMessage:r.group.blast?r.group.blast.content:"",blastMessageSecure:r.group.blast?r.group.secureBlast.content:"",blastUserId:r.group.blast?r.group.blast.userId:"",blastDateAdded:r.group.blast?e.moment(r.group.blast.dateBlastAdded,"X"):e.moment(),blastUserName:r.group.blast?r.group.blast.userName:"",blastPathAlias:r.group.blast?r.group.blast.userPathAlias:"",blastRealName:r.group.blast?r.group.blast.realName:"",blastUserStatus:r.group.blast?r.group.blast.userStatus:""},o.addOrUpdate(c),a={id:r.group.id,pathAlias:r.group.pathAlias||n.pathAlias,description:r.group.description.content,secureDescription:r.group.secureDescription?r.group.secureDescription.content:"",rules:r.group.rules.content,roles:r.group.roles,secureRules:r.group.secureRules.content,restrictions:r.group.restrictions,throttle:r.group.throttle,poolPreviewRowsVisibleCount:r.group.pool_rows,group:l,discussionsLocked:r.group.isLocked==="1",hasPendingInvite:r.group.has_pending_invite,coverPhotoAttribution:r.group.coverphoto},i.addOrUpdate(a),i.proxy(a.id)}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.groups.getInfo",this._processParams(n),!0),r.getModelRegistry("group-info-models"),r.getModelRegistry("group-models"),r.getModelRegistry("group-blast-models"),r.getModelRegistry("group-activity-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-groups-getInfo"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["group-info-models","group-models"]});
YUI.add("flickr-favorites-add-updater",function(e,t){"use strict";function n(n,r){var i={};return i.photo_id=n.photoId,r.callAPI("flickr.favorites.add",i).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-favorites-add"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("flickr-favorites-remove-updater",function(e,t){"use strict";function n(n,r){var i={};return i.photo_id=n.photoId,i.user_id=n.userId,r.callAPI("flickr.favorites.remove",i).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-favorites-remove"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("photo-model-helper",function(e){e.PhotoModelHelper={updateEngagement:function(t,n){var r=[],i;return e.Lang.isObject(n,!0)&&"isFaved"in n&&(i=n.isFaved.newVal?"flickr-favorites-add":"flickr-favorites-remove",r.push(e.ModelUpdaters[i].run({photoId:t},this.appContext))),e.Promise.all(r)},toggleFave:function(e){var t=this.getValue(e,"faveCount"),n=this.getValue(e,"isFaved"),r=!n,i="photo-engagement-models",s=t+(r?1:-1);this.setValues(e,{isFaved:r,faveCount:s}),this.name!==i&&this.appContext.getModelRegistry(i).then(function(t){t.exists(e)&&t.toggleFave(e)})},addAsFave:function(e){var t=this.getValue(e,"faveCount"),n=this.getValue(e,"isFaved"),r="photo-engagement-models";return n||this.setValues(e,{isFaved:!0,faveCount:t+1}),this.name!==r&&this.appContext.getModelRegistry(r).then(function(t){t.exists(e)&&t.toggleFave(e)}),!n},getLargestSize:function(e,t){return this.getSizeToFit(e,{width:Number.MAX_VALUE,height:Number.MAX_VALUE},t)},getSizeToFit:function(t,n,r){r=r||{};var i=this,s,o=n.width,u=n.height,a=!!r.cropToFit,f=r.includeSquare,l=r.sizes||this.getValue(t,"sizes"),c=r.excludeSizes||["o"],h=r.includeSizes,p,d,v;if(typeof r.includeSizes=="undefined")try{h=Object.keys(l)}catch(m){e.Flog.warn("[photo-model-helper] getSizeToFit with invalid sizes:",l)}return this._getSizeToFitMemo=this._getSizeToFitMemo||{},s=[t,o,u,a,c.sort().join(""),h.sort().join("")].join("_"),this._getSizeToFitMemo[s]||(e.Object.each(l,function(e,n){var r,i,s,l,m,g;if(e&&c.indexOf(n)===-1&&h.indexOf(n)>-1)if(f||!this.isSizeSquare(n)||this.isPhotoSquare(t)){r=parseInt(e.width,10),i=parseInt(e.height,10),a&&r>=o&&i>=u?s=!0:!a&&(r>=o||i>=u)&&(s=!0),s&&(p?(l=parseInt(p.height,10),i<l&&(p=e)):p=e);if(d){m=parseInt(d.width,10),g=parseInt(d.height,10);if(r>m||i>g)d=e}else d=e}v=p||d},this),this._getSizeToFitMemo[s]=v,this._getSizeToFitMemoTimer||(this._getSizeToFitMemoTimer=setTimeout(function(){delete i._getSizeToFitMemo,delete i._getSizeToFitMemoTimer},1e4))),e.clone(this._getSizeToFitMemo[s],!0)},getSizeIfExact:function(e,t){var n=this.getValue(e,"sizes"),r,i;return Object.keys(n).some(function(e){return e==="o"?!1:(i=n[e],t.height===i.height&&t.width===i.width?(r=i,!0):!1)}),r},isSizeSquare:function(e){var t={sq:"sq",q:"q"};return!!t[e]},isPhotoSquare:function(t){var n;return this._isPhotoSquareMemo=this._isPhotoSquareMemo||{},typeof this._isPhotoSquareMemo[t]!="undefined"?n=this._isPhotoSquareMemo[t]:(n=!0,e.Object.some(this.getValue(t,"sizes"),function(e,t){var r;if(e&&e.width&&e.height&&!this.isSizeSquare(t)){r=parseInt(e.width,10)/parseInt(e.height,10);if(r!==1)return n=!1,!0}},this),this._isPhotoSquareMemo[t]=n),n},attributes:{title:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},description:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},mediaType:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:"photo"},license:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},isVideo:{readOnly:!0,derivedBy:["mediaType"],getter:function(e,t){var n=this.getValue(t,"mediaType");return n==="video"}},isOwner:{readOnly:!0,derivedBy:["owner"],getter:function(e,t){var n=this.getValue(t,"owner"),r=this.appContext.getViewer();return!!r.signedIn&&n.getValue("id")===r.nsid}},sizes:{},descendingSizes:{readOnly:!0,derivedBy:["sizes"],defaultFn:function(e){var t,n,r=[];this._descendingSizesMemo=this._descendingSizesMemo||{};if(this._descendingSizesMemo[e])return this._descendingSizesMemo[e];t=this.getValue(e,"sizes");for(n in t)r.push(t[n]),r[r.length-1].key=n;return r.sort(function(e,t){return e.width<t.width?1:e.width===t.width?e.height<t.height?1:e.height===t.height?e.key==="o"?-1:1:-1:-1}),this._descendingSizesMemo[e]=r,r}},ascendingSizes:{readOnly:!0,derivedBy:["descendingSizes"],defaultFn:function(e){return this.getValue(e,"descendingSizes").reverse()}},aspectRatio:{readOnly:!0,derivedBy:["descendingSizes","rotation"],defaultFn:function(e){var t=this.getValue(e,"descendingSizes")[0];return t.key==="o"&&this.getValue(e,"rotation")%180!==0?t.height/t.width:t.width/t.height}},needsInterstitial:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},canComment:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!0},canPublicComment:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},url:{readOnly:!0,derivedBy:["owner"],defaultFn:function(e){var t=this.getValue(e,"owner");return t?"/photos/"+t.getValue("pathAlias")+"/"+e:undefined}},rotation:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},ownerNsid:{},isFaved:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},faveCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},commentCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},canFave:{readOnly:!0,derivedBy:["is_owner"],getter:function(e,t){return!this.getValue(t,"isOwner")}},is3MP:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},ownerCountryApproved:{validator:function(t){return e.
AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},ownerFollowedByCurators:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},ownerAdded:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},ownerPassedOver:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},statusColor:{defaultValue:""},isMarketplaceLicensable:{defaultFn:function(e){return!1}},marketplaceLicensingUrl:{setter:function(e){return e&&e.indexOf("http")<0&&(e="http://"+e),e},defaultFn:function(e){return""}}}}},"@VERSION@",{requires:["flickr-favorites-add-updater","flickr-favorites-remove-updater"]});
YUI.add("group-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,parseGroupModel:function(t,n,r){var i={id:r.id||t||r.nsid,pathAlias:r.pathAlias||n||r.pathalias,title:r.title,invitationOnly:r.invitationOnly,memberCount:r.memberCount,poolCount:r.photos,poolPreviewRowsVisibleCount:r.pool_rows,topicCount:r.topicCount==="string"?r.topicCount:undefined,pendingCount:r.pool_pending_count,memberPendingCount:r.member_pending_count,iconurls:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(r.iconurls),isMember:r.is_member||r.member||r.isMember,isModerator:r.is_moderator||r.moderator||r.isModerator,isAdmin:r.is_admin||r.admin||r.isAdmin,eighteenplus:r.eighteenplus,coverPhotoUrls:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(r.coverphotoUrl),latestPhotoActivity:e.moment(r.date_activity_detail?r.date_activity_detail.pool:undefined,"X"),latestDiscussionActivity:e.moment(r.date_activity_detail?r.date_activity_detail.discussions:undefined,"X"),showPoolToNonMembers:r.show_pool,showDiscussionToNonMembers:r.show_discussion,needsInterstitial:r.needs_interstitial},s;return typeof r.datecreate=="string"?s=r.datecreate:r.datecreate&&typeof r.datecreate.content=="string"&&(s=r.datecreate.content),s?(s+=" +0700",i.dateCreated=e.moment(s,"YYYY-MM-DD HH:mm:ss Z")):i.dateCreated=new e.moment,!i.title&&r.name&&(i.title=typeof r.name=="string"?r.name:r.name.content),!i.memberCount&&r.members&&(i.memberCount=typeof r.members!="string"?r.members.content:r.members),!i.poolCount&&r.poolCount&&(i.poolCount=typeof r.poolCount!="string"?r.poolCount.content:r.poolCount),i.topicCount||(r.topicCount?i.topicCount=typeof r.topicCount!="string"?r.topicCount.content:r.topicCount:i.topicCount=0),r.privacy&&(parseInt(r.privacy,10)?i.privacy=parseInt(r.privacy,10):r.privacy.content&&(i.privacy=r.privacy.content)),i},getLargestCoverPhotoSize:function(t,n){return e.PhotoModelHelper.getLargestSize(t,n)},attributes:{title:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},pathAlias:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||undefined},defaultFn:function(e){return e}},isModerator:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},invitationOnly:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isMember:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isAdmin:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},memberCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return 0}},poolCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return 0}},friendlyPoolCount:{readOnly:!0,derivedBy:["poolCount"],getter:function(t,n){return e.Number.format(this.getValue(n,"poolCount"),{thousandsSeparator:","})}},pendingCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return 0}},memberPendingCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return 0}},topicCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return 0}},groupPoolAddURL:{readOnly:!0,derivedBy:["pathAlias"],defaultFn:function(e){return"/groups/"+this.getValue(e,"pathAlias")+"/pool/add/"}},dateCreated:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},defaultFn:function(t){return e.moment()},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},latestPhotoActivity:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},defaultFn:function(t){return e.moment()},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},latestDiscussionActivity:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},defaultFn:function(t){return e.moment()},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},showPoolToNonMembers:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},showDiscussionToNonMembers:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},eighteenplus:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},needsInterstitial:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},privacy:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return 0}},iconurls:{},bestIconURL:{readOnly:!0,derivedBy:["iconurls"],defaultFn:function(t){var n=e.URLHelper.getGroupIconURL(this.getValue(t,"iconurls")
);return n?n:undefined}},url:{readOnly:!0,derivedBy:["group"],defaultFn:function(e){return"/groups/"+(this.getValue(e,"pathAlias")||e)+"/"}},urlMembersPage:{readOnly:!0,derivedBy:["group","url"],defaultFn:function(e){return this.getValue(e,"url")+"members"}},urlPoolPage:{readOnly:!0,derivedBy:["group","url"],defaultFn:function(e){return this.getValue(e,"url")+"pool"}},urlDiscussionPage:{readOnly:!0,derivedBy:["group","url"],defaultFn:function(e){return this.getValue(e,"url")+"discuss"}},urlPendingMembersPage:{readOnly:!0,derivedBy:["id"],defaultFn:function(e){return"/groups_pending.gne?id="+e}},urlPendingPhotosPage:{readOnly:!0,derivedBy:["pathAlias"],defaultFn:function(e){return"/groups/"+this.getValue(e,"pathAlias")+"/admin/pending"}},coverPhotoUrls:{},latestGroupActivity:{readOnly:!0,derivedBy:["latestPhotoActivity","latestDiscussionActivity","dateCreated"],defaultFn:function(t){var n=this.getValue(t,"latestDiscussionActivity"),r=this.getValue(t,"latestPhotoActivity"),i=this.getValue(t,"dateCreated"),s=i;return n.isValid()&&(s=e.moment.min(s,n)),r.isValid()&&(s=e.moment.min(s,r)),s}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","api-helper","url-helper","moment","flickr-groups-getInfo-fetcher","attribute-helpers","photo-model-helper"]});
YUI.add("flickr-licensing-curation-passOverUser-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.licensing.curation.passOverUser",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-licensing-curation-passOverUser"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
